<style>
	/*抽奖页面*/
	html, body {
		height: 100%;
		padding: 0;
		margin:0;
		background: url(/images/screen_bg.jpg) no-repeat;
		background-size: cover;
		
	}
	a {
		color: #ffffff;
	}
	.screen_tittle{
		position: fixed;
		left: 30px;
		top: 20px;
		height: 40px;
	}
	.screen_tittle img {
		height: 100%;
	}
	.prize_text{
		display: none;
		text-align: center;
		position: fixed;
		top: 16px;
		width: 100%;
		height: 70px;
   }
   .prize_text img {
	   	height: 100%;
   }
	#info {
		position: absolute;
		width: 100%;
		color: #ffffff;
		padding: 8px;
		font-family: Monospace;
		font-size: 13px;
		font-weight: bold;
		text-align: center;
		z-index: 1;
	}

	#menu {
		position: absolute;
		bottom: 1px;
		width: 100%;
		text-align: center;
		display: none!important;
	}

	.element {
		width: 320px;
		height: 380px;
		box-shadow: 0px 0px 12px rgba(63, 81, 181,0.8);
		border: 1px solid rgba(63, 81, 181,0.5);
		text-align: center;
		cursor: default;
	}

	.element:hover {
		box-shadow: 0px 0px 12px rgba(63, 81, 181,0.75);
		border: 1px solid rgba(63, 81, 181,0.75);
	}

	.element .number {
		display: none;
		position: absolute;
		top: 10px;
		right: 10px;
		font-size: 12px;
		color: white;
		z-index: 1;
	}

	.element .symbol {
		position: absolute;
		top: 10px;
		left: 50%;
		width: 300px;
		margin-left: -150px;
		height: 300px;
		/*// font-size: 20px;*/
		font-weight: bold;
		color: rgba(255,255,255,0.75);
		text-shadow: 0 0 10px rgba(0,255,255,0.95);
	}

	.element .details {
		position: absolute;
		bottom: 7px;
		left: 0px;
		right: 0px;
		font-size: 40px;
		height: 60px;
		line-height: 60px;
		text-align: center;
		color: #fff;
	    white-space: nowrap;
	    overflow: hidden;
	}

	.blbl {
		background-color: rgba(255,57,57,1) !important;
		box-shadow: 0px 0px 12px rgba(255,57,57,1);
		border: 1px solid rgba(255,0,0,.5);
	}

	.act {
		 background-color: rgba(134, 1, 177, 0.8) !important;
		opacity: 0.5 !important;
	}

	.wins {
		opacity: 0.25;
	}

	button {
		color: rgba(127,255,255,0.75);
		background: transparent;
		outline: 1px solid rgba(127,255,255,0.75);
		border: 0px;
		padding: 5px 10px;
		cursor: pointer;
	}
	button:hover {
		background-color: rgba(0,255,255,0.5);
	}
	button:active {
		color: #000000;
		background-color: rgba(0,255,255,0.75);
	}

	.result{
		display: none;
		text-align: center;
		position: absolute;
		width: 100%;
		height: 100%;
		background: rgba(255,255,255,.9);
		overflow-y :auto;
	}
	.result-div{
		border: 2px solid rgba(0,0,0,0.15);
		margin: 10px 0;
		border-radius: 5px;
		color:red;
	}
	.result-span{
		float: left;
		border: 1px solid rgba(0,0,0,0.25);
		padding: 5px;
		background: rgba(127,255,255,1);
		margin: 5px;
		border-radius: 5px;
	}
	.result-close{
		position: fixed;
		bottom: 10px;
		right: 10px;
		background: rgba(0,0,0,.8);
		padding: 15px;
		color: white;
		border-radius:5px;
		cursor: pointer;
	}
	.result-history{
		position: fixed;
		bottom: 10px;
		left: 10px;
		color: rgba(0,0,0,.8);
		padding: 15px;
		border-radius:5px;
		cursor: pointer;
	}

	@-webkit-keyframes fadeIn {
	  from {
	    opacity: 0;
	  }

	  to {
	    opacity: 1;
	  }
	}

	@keyframes fadeIn {
	  from {
	    opacity: 0;
	  }

	  to {
	    opacity: 1;
	  }
	}

	.fadeIn {
	  -webkit-animation-name: fadeIn;
	  animation-name: fadeIn;
	}

	.animated {
	  -webkit-animation-duration: 1s;
	  animation-duration: 1s;
	  -webkit-animation-fill-mode: both;
	  animation-fill-mode: both;
	}
</style>
<div class="screen_tittle"><img src="/images/screen_logo.png" alt=""></div>
<div class="prize_text"><img src="/images/screen_text.png" alt="" ></div>
<div id="container" style="width: 100%;height: 100%;"></div>
<div id="menu">
	<button id="table">TABLE</button>
	<button id="sphere">SPHERE</button>
	<button id="helix">HELIX</button>
	<button id="grid">批量抽奖</button>
	<button id="run30">循环3次</button>
	<button id="begin">开始</button>
	<button id="end">结束</button>
	<button id="result-open">查看结果</button>
	<button id="next">下轮抽奖</button>
	<select id="round">
		<option value="1">第1轮</option>
		<option value="2">第2轮</option>
		<option value="3">第3轮</option>
		<option value="4">第4轮</option>
		<option value="5">第5轮</option>
	</select>
	<button id="reset">重置结果</button>
</div>

<div class="result animated fadeIn">
	<span class="result-close">关闭</span>
	<div id="result-content" style="margin: 10px;">
	</div>
</div>

<audio id="music" src="/audio/prize1.mov" loop="loop"></audio>

<div id="prized_users_mask">
    <div class="prized-users-container" id="prized_users_container">
    </div>
</div>

<style>
	#prized_users_mask {
		display: none;
		width: 100%;
	    height: 100%;
	    z-index: 10000;
	    position: fixed;
	    left: 0;
	    top: 0;
	    background: rgba(0, 0, 0, 0.7);
	}

	.prized-users-container {
		position: absolute;
		top: 50%;
		left: 50%;
		width: 1000px;
		height: 760px;
		transform: translate(-50%, -50%);
		display: flex;
		flex-direction: row;
		justify-content: center;
		align-items: center;
	    flex-wrap: wrap-reverse;
	    overflow: hidden;
	}
	.prized-users-element {
		background: #fff;
		position: relative;
		box-shadow: 0px 0px 12px rgba(63, 81, 181,0.75);
		border: 1px solid rgba(63, 81, 181,0.75);
		margin: 15px;
	}
	.prized-users-avatar {
		display: block;
		width: 240px;
		height: 240px;
		border: none;
	}
	.prized-users-name {
		height: 40px;
		line-height: 40px;
		font-size: 18px;
		color: #444;
		text-align: center;
	}
</style>
<script>
	var zoom_define = [
		[2, 1.5],
		[3, 1.2],
		[5, 1.2],
		[10, 0.8],
		[20, 0.62],
		[28, 0.52],
		[36, 0.48],
		[40, 0.45],
		[80, 0.307]
	];

	function get_zoom(count) {
		var zoom;
		for (let item of zoom_define) {
			let need_count = item[0];
			zoom = item[1];

			if (count <= need_count) {
				break;
			}
		}
		return zoom;
	}

	var prized_users_mask = document.getElementById("prized_users_mask")
	var prized_users_container = document.getElementById("prized_users_container")
	function display_prized_users(users) {
		var element_html = [];
		var zoom = get_zoom(users.length);
		for (var i = 0; i < users.length; i++) {
			var user = users[i];
			if (users.length > 40) {
				user.name = String(user.name || '').split('-').pop();
			}

			element_html.push(`<div style="zoom: ${zoom}" class="prized-users-element"><img class="prized-users-avatar" src="${user.avatar}"><div class="prized-users-name">${user.name}</div></div>`);
		}
		
		prized_users_container.innerHTML = element_html.join('');
		prized_users_mask.style.display = 'block';
	}

	function undisplay_prized_users() {
		prized_users_mask.style.display = 'none';
	}

	socket.on('_server_push_/prize_result_users', function(err, data) {
		if (data.users && data.users.length) {
			display_prized_users(data.users);
		}
	});

	socket.on('_server_push_/prize_result_hide', undisplay_prized_users);

</script>
<script>
window._prize_users_ = {{json users}};
window._prize_winner_ids_ = {{json winner_ids}};
</script>

<script src="/javascripts/prize/three.min.js"></script>
<script src="/javascripts/prize/tween.min.js"></script>
<script src="/javascripts/prize/TrackballControls.js"></script>
<script src="/javascripts/prize/CSS3DRenderer.js"></script>
<script src="/javascripts/prize/chouj.js"></script>
<script src="/javascripts/prize/base.js"></script>
